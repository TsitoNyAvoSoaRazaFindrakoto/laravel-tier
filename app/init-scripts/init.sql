-- Insérer des cryptos
INSERT INTO crypto (crypto) VALUES
('Bitcoin'),
('Ethereum'),
('Ripple'),
('Litecoin'),
('Cardano');

-- Insérer des prix pour les cryptos
INSERT INTO "cryptoPrix" ("prixUnitaire", "dateHeure", "idCrypto") VALUES
(30000.00, '2025-01-01 10:00:00', 1),
(2000.00, '2025-01-01 10:00:00', 2),
(0.50, '2025-01-01 10:00:00', 3),
(100.00, '2025-01-01 10:00:00', 4),
(1.20, '2025-01-01 10:00:00', 5);

INSERT INTO "cryptoPrix" ("prixUnitaire", "dateHeure", "idCrypto") VALUES
                                                                       (1500.00, '2025-02-01 10:00:00', 1),
                                                                       (2300.00, '2025-02-01 10:00:00', 2),
                                                                       (10, '2025-02-01 10:00:00', 3),
                                                                       (50.00, '2025-02-01 10:00:00', 4),
                                                                       (10.20, '2025-02-01 10:00:00', 5);

-- Insérer des transactions de fonds utilisateur
INSERT INTO fondUtilisateur (entree, sortie, "idUtilisateur") VALUES
(1000.00, 0.00, 1),
(2000.00, 0.00, 2),
(1500.00, 0.00, 3),
(500.00, 0.00, 4),
(100.00, 0.00, 5),
(3000.00, 500.00, 6),
(1000.00, 200.00, 7),
(500.00, 50.00, 8),
(10000.00, 1000.00, 9),
(5000.00, 2500.00, 10);

-- Insérer des transactions crypto
INSERT INTO "transCrypto" ("idUtilisateur", entree, sortie, "prixUnitaire", "dateTransaction", "idCrypto") VALUES
(1, 0.05, 0.00, 30000.00, '2025-01-02 11:00:00', 1),
(2, 0.10, 0.00, 2000.00, '2025-01-02 12:00:00', 2),
(3, 0.00, 0.02, 30000.00, '2025-01-03 13:00:00', 1),
(4, 5.00, 0.00, 0.50, '2025-01-03 14:00:00', 3),
(5, 10.00, 0.00, 100.00, '2025-01-04 15:00:00', 4),
(6, 0.00, 100.00, 1.20, '2025-01-04 16:00:00', 5),
(7, 0.02, 0.00, 30000.00, '2025-01-05 17:00:00', 1),
(8, 1.00, 0.00, 2000.00, '2025-01-05 18:00:00', 2),
(9, 0.00, 3.00, 0.50, '2025-01-06 19:00:00', 3),
(10, 2.00, 0.00, 100.00, '2025-01-06 20:00:00', 4),
(1, 0.01, 0.00, 30000.00, '2025-01-07 11:00:00', 1),
(2, 0.00, 0.05, 2000.00, '2025-01-07 12:00:00', 2),
(3, 4.00, 0.00, 0.50, '2025-01-08 13:00:00', 3),
(4, 0.00, 5.00, 100.00, '2025-01-08 14:00:00', 4),
(5, 8.00, 0.00, 1.20, '2025-01-09 15:00:00', 5),
(6, 0.00, 0.02, 30000.00, '2025-01-09 16:00:00', 1),
(7, 0.20, 0.00, 2000.00, '2025-01-10 17:00:00', 2),
(8, 0.00, 2.00, 0.50, '2025-01-10 18:00:00', 3),
(9, 3.00, 0.00, 100.00, '2025-01-11 19:00:00', 4),
(10, 1.00, 0.00, 1.20, '2025-01-11 20:00:00', 5),
(1, 0.05, 0.00, 30000.00, '2025-01-12 11:00:00', 1),
(2, 0.00, 0.10, 2000.00, '2025-01-12 12:00:00', 2),
(3, 0.01, 0.00, 0.50, '2025-01-13 13:00:00', 3),
(4, 2.00, 0.00, 100.00, '2025-01-13 14:00:00', 4),
(5, 0.00, 1.00, 1.20, '2025-01-14 15:00:00', 5),
(6, 0.10, 0.00, 30000.00, '2025-01-14 16:00:00', 1),
(7, 0.00, 0.02, 2000.00, '2025-01-15 17:00:00', 2),
(8, 1.00, 0.00, 0.50, '2025-01-15 18:00:00', 3),
(9, 0.00, 0.01, 100.00, '2025-01-16 19:00:00', 4),
(10, 5.00, 0.00, 1.20, '2025-01-16 20:00:00', 5);

SELECT percentile_cont(0.25) WITHIN GROUP (ORDER BY "prixUnitaire") AS "premierQuartile", "idCrypto"
FROM "cryptoPrix" group by "idCrypto";

SELECT cast(stddev("prixUnitaire") as double precision) AS "ecartTypeEchantillon",
       cast(stddev_pop("prixUnitaire") as double precision) AS "ecartTypePopulation",
       "idCrypto"
FROM "cryptoPrix" group by "idCrypto";
